import os
import pandas as pd


def retrieve_hash_with_cwe(file_path):
    """

    :param file_path: a csv file containing hash, cve, cwe
    :return: hash and cwe
    """
    hash_cve_cwe_df = pd.read_csv(file_path, header=None)
    hash = hash_cve_cwe_df[:][0]
    cwe = hash_cve_cwe_df[:][2]

    return hash, cwe

def retrieve_hash_with_author(file_path):
    """

    :param file_path: a csv file containing hash, author
    :return: hash and author name
    """
    hash_author_df = pd.read_csv(file_path, header=None)
    hash = hash_author_df[:][0]
    author = hash_author_df[:][1]

    return hash, author


def dict_with_count(array):
    """

    :param array: array of ids
    :return: a sorted dictionary with ids and count
    """
    dict = {}
    for row in array:
        if row not in dict.keys():
            dict.update({row: 1})
        else:
            count = dict[row]
            dict[row] = count + 1
    dict = sorted(dict.items(), key=lambda x: x[1], reverse=True)
    return dict

